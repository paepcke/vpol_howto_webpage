<!DOCTYPE html>
<html>
  <head>
  <title>Datastage Data Access How-To</title>
    <style>
      body
      {
      background-color:#b0c4de;
      }
      #spanhand
      {
      font-style: bold;
      font-size: 150%;
      display: inline-block;
      }
      
      /* Table header style: */
      .tg .tg-s6z2
      {text-align:center; 
       font-style: bold;
       font-size: 130%;
      }

    </style>

    <script LANGUAGE="JavaScript">
    <!-- Hiding JavaScript>

    function showEmailAddr()
    {
      var theName = "Paepcke";
      var theAt = "@";
      var theDomain = "CS.Stanford.edu";
      var theMailTo = "<A HREF='mailto:" + theName + theAt + theDomain + "'>";
      var theMailToClose = "</A>";

      document.write(theMailTo + theName + theAt + theDomain + theMailToClose);
    }// End hiding JavaScript -->
    </script>

  </head>

  <body>

<center><h1>How to Access the VPOL Online Learning Data</h1></center>

<ul>
<!-- ****** <li><a href="http://mono.stanford.edu:8000">AnswerServer</a></li> -->
  <li><a href="#accessProcedure">Protocol for Access</a></li>
  <li><a href="#dataSummary"><span id="spanhand">Summary of Available Data</a></span></a>&#8592;Good section to check out</li>
  <li><a href="#appA">List of available data sets</a></li>
  <li><a href="#appB"><span id="spanhand">Explanation of OpenEdX data fields</span></a>&#8592;Good section to check out</li>
  <li><a href="#mirrors">OpenEdX platform tables mirrored on datastage</li>
  <li><a href="#functions">Handy MySQL functions and procedures</li>
  <li><a href="accessMechanics.html#dbConn">Preparing your machine for connecting to
      databases</a></li>
  <li><a href="accessMechanics.html#excel">Connecting from Excel</a></li>
  <li><a href="accessMechanics.html#spss">Connecting from SPSS</a></li>
  <li><a href="accessMechanics.html#razorSQL">Connecting from RazorSQL or Froq</a></li>
  <li><a href="accessMechanics.html#pickUp">Picking up visualizations prepared
  by staff or friends</a></li>
  <li><a href="accessMechanics.html#sshTunnel">How to build an ssh tunnel</a></li>
  <li><a href="https://docs.google.com/document/d/1WlWkaFkpzt9i3zGVqGYAnxK_wdklUncOnh4A0T5yeJs/edit?pli=1">Example queries</a></li>
  <li><a href="http://www.tableausoftware.com/public/gallery">Gallery
  of example data visualizations</a></li>
</ul>


The Vice Provost Office for Online Learning facilitates the teaching
of online classes. The instruction delivery platforms are instrumented
to collect a variety of data around participants' interaction with the
study material. Examples are participants manipulating video players as
they view portions of a class, solution submissions to problem sets,
uses of the online forum available for some classes, peer grading
activities, and some demographic data. The type of data that is
collected depends on the delivery platform used for a particular
class.
<p>
VPOL makes some of this data available for research on learning
processes, and for explorations into improving instruction.
<p>
All data that VPOL shares is available on machine
<i>datastage.stanford.edu</i>. You have multiple methods of using this data:
We provide self service answers to frequent questions, customizable to
your context. Data viewing programs for MAC and Windows allow you to
browse through our content. Going further, most analysis tools, like
R, SPSS, and Excel can connect directly to our databases. Similarly,
visualization tools are available that allow you to create static, or
interactive charts of data directly from our sources. We explain these
access methods here, or point to relevant instructions on the Web.
<p>
Additionally, we run
a <a href="http://www.tableausoftware.com/products/server">Tableau Server</a>
to which you can publish visualizations you create with the Tableau
Desktop visualization tool. Visitors can manipulate these
visualizations to the degree you provide for. A comment area is
available for each view to discuss the information. If desired, access
to the views can be limited. Again, more in this document.

We now run through the available access paths to the data, ordered in
increasing power (and sometimes associated complexity).

<h2 id="accessProcedure">Protocols for Access</h2>

Even though we do not keep highly sensitive information on this
server, we do need to protect the data from malicious intrusion. If
you are interested in studying the data, please fill out
<a href="http://vpol.stanford.edu/research">our request form</a>.
<p>
While the form accommodates requests for data with personally
identifiable information, we can only provide such access in special
cases. The data from which personalized information has been removed
is quite rich. Please at least try to work with that data until you
have a firm research plan in mind.
<p>
If you are the instructor of a class, and you need the data to improve
future runs of your course, the personally identifiable data is more
freely available than if the data is used for research.
<p>
Please take the online non-medical human subjects research certification
class
(<a href="https://humansubjects.stanford.edu/new/resources/training/citi.html">
    through Stanford</a>
or <a href="https://www.citiprogram.org/">through CITI</a>, or some
other
institution). Then <a href="mailto:upload.IRBcert.ucf1bw6ifx@u.box.com">email
    your resulting PDF file.</a> 
<p>
If you publish a paper, we appreciate credit for the data, and a note
telling us about how you used the material. Both of these steps help
us justify the cost of data collection, and we are plain interested in
what you find!

<h2 id="dataSummary">Summary of Available Data</h2>
Datastage holds learning research data derived from courses offered on
three platforms: NovoEd, Coursera, and OpenEdX.  Documentation on
Coursera export formats are
described <a href="https://spark-public.s3.amazonaws.com/mooc/data_exports.pdf">
in a separate document</a>. For NovoEd format documentation you need
to browse their tables. Here is a summary of data that is available
for Stanford courses taught on OpenEdX. For more in-depth information
see <a href="#appB">Explanation of OpenEdX data fields</a>.
</p>
Data include both raw numbers that the OpenEdX platform collects, and
tables that result from computations over that base data.
<p>
<b>Note: </b><i>tracking log</i> data that the platform collects is
known to be incomplete. Tracking logs list small actions that
participants undertake when interacting with a course through their
browser. Examples are video playback controls, and assignment
submissions. The platform instrumentation misses an unknown number of
these events. The EdX consortium is working on this issue. Meanwhile,
consider data based on tracking logs a conservative
estimate. Reportedly, Coursera tracking logs experience similar
missing data.
</p>
<h3>Stored tables and Associated Views</h3>
<ul>
 <li><b>CourseInfo</b>: Facts about courses, such as start/end dates,
   academic year and quarter in which a course was offered.</li>
 <li> <b>ActivityGrade</b>: Assignment grades; includes right/wrong for each
   problem part, the learners' solution choice for each answer pard,
   and the first and last solution submission times. Constructed from platform table
   courseware_studentmodule.</li>

 <li> <b>Performance</b>: Daily cumulative assignment performance per
   learner. This is the average grade over all assignments up to the
   day before the query. A view onto ActivityGrade. </li>

 <li> <b>FinalGrade</b>: 'Raw' final grades. Raw in that they do not
   take into account instructor defined weightings. This is an
   anonymized view onto the private table UserGrade (see
   below). FinalGrade differs from the Performance table in that it
   reflects the platform's current grade. That grade might reflect
   work other than the assignments that are captured in the
   ActivityGrade table.</li>
   
 <li><b>UserGrade</b>: Raw grades as recorded by the platform. An
   amalgam of the platform tables auth_user and
   certificates_generatedcertificate.</li>

 <li><b>ABExperiment</b>: Data resulting from the use of the OpenEdX AB
   testing facilities.</li>

 <li><b>OpenAssessment</b>: Data resulting from the use of the OpenEdX
   peer grading facilities.</li>

 <li> <b>UserCountry</b>: country of origin by IP address. Each row is a tuple
   consisting of one anonymous user id, the two-letter country code,
   the three-letter country code, and the spelled-out country. If a
   participant accesses the platform from different IP addresses,
   each IP address has its own row in the table. Multiple accesses
   from the same IP generate just one row.</li>

 <li> <b>EdxForum.contents</b>: Forum entries since about June
   2013. The entries are in relational form. Two versions can be
   generated: anonymized with hashed user ids
   different from the hashes used in other tables, and anonymized
   using the same hashes.</li>

 <li> <b>VideoInteraction</b>: an excerpt from tracking logs, focusing on
   participants' interactions with video.</li>

 <li><b>EventXtract</b>: A much slimmed view of the OpenEdX tracking log
   events. The view only includes fields that are currently in use by
   the platform. </li>
 <li><b>LoadInfo</b>: Information about archive updates.</li>
 <li><b>EdxPrivate.EventIp</b>:IP addresses for each event. This table
     is only available by special arrangement.</li>
</ul>

<b>State, InputState, Answer, and CorrectMap</b> are subsumed by the
  tables above. If you are familiar with the OpenEdX tracking log
  event format, you will recognize the names, and can use them
  individually.</li>
   
<h3>Computed tables</h3>

<ul>
 <li> <b>Time-on-task</b>: estimate for how long participants worked online on
   their courses. Computed from tracking log events, and partitioned
   into 30 minute sessions. Available: every session for every participant
   and course, weekly aggregates of the sessions, and course level
   aggregates. Session length for the computations can be customized
   on request, but this is a manual process. Part of the canned table
   exports, because this table is computed on demand, not stored (see
   next section)</li>

</ul>

<h3>Canned exports</h3>

<ul>
 <li> The tracking log data, video interactions, activity grade, forum
      posts, and time-on-task tables can be exported per course, and picked up over
   the Web.</li>

 <li> Other interactions with the tables require access to our server,
   and knowledge of SQL.</li>
</ul>

<h3>Mirrored OpenEdX Platform Tables</h3>

A number of <a href="#mirrors">tables are mirrored</a> from the
Stanford OpenEdX platform with delay. This collection can be extended.

<!-- <h2>If We Anticipated your Question</h2> -->

<!-- In the simplest case your question has been asked and answered before, -->
<!-- albeit for a different context. Such a context might be a particular -->
<!-- class for which the question was originally asked, or a particular -->
<!-- problem set. For cases like this -->
<!-- our <a href="http://mono.stanford.edu:8000">AnswerServer</a> will -->
<!-- eventually help. It is <b>under construction</b>. This server differs -->
<!-- from a typical FAQ list in that you are able to adjust the question to -->
<!-- your context. We will be growing the coverage of that page as we go -->
<!-- along. If you have an idea for a useful one-liner question, please -->
<!-- send email to <script LANGUAGE="JavaScript">showEmailAddr()</script>. -->


<h2 id="appA">Available Databases</h2>

<h3>List of available courses</h3>

The archive includes data from the following Stanford courses:
<ul>
<li>Courses that were offered using Stanford's
<a href="handleCourseNameRequest.php?platform=openedx"
   target="_blank">OpenEdX platform.</a></li>
<li>Courses delivered on
    the <a href="handleCourseNameRequest.php?platform=coursera"
    target="_blank"> Coursera platform.</a>, and</li>
<li>Courses that utilized the<a href="handleCourseNameRequest.php?platform=novoed" target="_blank">
    NovoEd platform.</a></li>
</ul>
<p>
In addition the archive
includes <a href="handleCourseNameRequest.php?platform=moocdb"
target="_blank"> MOOCDb versions</a> for many of the above courses.
MOOCDb is a relational
<a href="http://edf.stanford.edu/readings/moocdb-developing-data-standards-mooc-data-science"
   target="_blank"> format that aims to combine schemas</a> from
   multiple online learning platforms.

<h3>Resources beyond this document</h3>

Data from Stanford courses offered via the OpenEdX platform software
by Stanford includes the above mentioned <i>events</i>, which document
how participants interacted with the platform. Forum posts are
available as well. All data has personally identifiable information
removed. 
<p>
For <a href="#appB">schema details of each OpenEdX table</a>, see
below. Meanings of OpenEdX data fields are also explained at
the <a href="http://edx.readthedocs.org/en/latest/">OpenEdX Consortium
Tracking Log documentation</a>
<p>
Forum data is explained in the <a href="http://devdata.readthedocs.org/en/latest/internal_data_formats/discussion_data.html">
OpenEdX Consortium</a> documentation.
<p>
Coursera <a href="https://spark-public.s3.amazonaws.com/mooc/20130414_data_exports.pdf">export
 format information</a> is a useful resource for understanding formats
 in the Coursera archives.


<h2 id="appB">Explanation of OpenEdX data fields</h2>

The Edx and EdxPrivate databases provide a lossless translation from
the OpenEdX platform tracking logs to relational tables. The
translation was constructed based on tracking logs of Stanford's
OpenEdX classes.
<p>
Each entry in a tracking log contains information about one small
interaction that one participant undertook with the learning
platform. Examples are the submission of a problem solution, a video
control action, like starting a video, or the initial creation of an
account. <b>Note:</b>the event collection process of the OpenEdX
platform is not perfect yet. Events do get lost on the way. The EdX
consortium is working on this issue. But meanwhile you need to
consider computations based on track logs as lower bounds.
<p>
<b>Beware 9c1185a5c5e9fc54612808977ee8f548b2258d31</b>: One event
track failure is that some screen names show up as empty strings. When
we anonymize these empty screen names, they all come to look like the
same anonymized person, the above ugly string. When we export tables
for you, we filter these duds out. But if you work on the database
tables themselves, you need to take of it yourself.
<p>
The logs were designed to hold every piece of information that might
need to be captured now or in the future. Not all of the log fields
are currently in use. Of the many columns in the relational tables
only some therefore need to be considered at this point. We therefore
created some tables that allow you to focus.
<p>
<ul>
  <li>EventXtract</li>
  <li>VideoInteraction and</li>
  <li>ActivityGrade</li>
</ul>
We call these the <i>basic</i> tables.  During export we partition the
tables into groups that correspond to the analysis purposes for which
they are intended. The <b>Basic Tables</b> are meant for everyday
use. Those tables exist in the database on Datastage, and we can
export extracts of the three tables for individual classes as well.
<p>
Export table group <b>Engagement</b> are tables that approximate how
much time course participants spent interacting with a course on their
computer. These tables are only available as per-course exports. They
do not exist in the database, but are computed when we export.  We
will add more table groups as we go along. 
<p>
Other tables of interests are <b>Demographics</b>, which provides
basic, anonymized info about each participant, and <b>EdxForum</b> the
Forum posts, upvotes, downvotes for all courses.

We describe the tables now,
group by group.

<hr>
<h3>Basic Export Tables</h3>

The first of the basic export tables is the main table, which contains
all the events: <i>EventXtract</i>. NOTE: the <i>event_type</i> field
is the key to interpreting the remaining columns. Please see the 
<a href="http://edx.readthedocs.org/en/latest/">OpenEdX
Tracking Log documentation</a> of the original JSON formatted
fields. Those descriptions are authoritative.
<p>
<style type="text/css">
.tg  {margin-left: auto; margin-right: auto}
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2">EventXtract</th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Anonymized participant identifier</td>
  </tr>
  <tr>
    <td class="tg-031e">event_type</td>
    <td class="tg-031e">Type of action the participant took
                        See <a href="http://edx.readthedocs.org/en/latest/">OpenEdX
                        Tracking Log documentation</a>
  </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">ip_country</td>
    <td class="tg-031e">Participant's country of origin based on IP
      address from which the action was performed. The field uses the
      standard three-letter country code (http://countrycode.org/). If
      country of origin is of special interest, consider table
      UserCountry, which contains every participant's action country
      of origin in two and three letter code, plus full name. IP addresses
      themselves are considered personally identifiable information, but are
      available by special request in the private table EdxPrivate.EventIp.
      </td> 
  </tr>
  <tr>
    <td class="tg-031e">time</td>
    <td class="tg-031e">Date and time when action was taken</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_display_name</td>
    <td class="tg-031e">Name of course for which action was taken</td>
  </tr>
  <tr>
    <td class="tg-031e">resource_display_name</td>
    <td class="tg-031e">Name of video, assignment, or teaching module
        associated with the action. This information is only as good
        as what instructors provided when constructing their course. </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">success</td>
    <td class="tg-031e">Whether the participant succeeded, or not (context dependent)</td>
  </tr>
  <tr>
    <td class="tg-031e">video_code</td>
    <td class="tg-031e">Machine name of video, (video actions only)
                        For YouTube videos this column allows you
                        to find the video itself. For example,
                        if this column contains '6Tnr8OL-9So' 
                        you can google that code, and will find
                        the video.
    </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_current_time</td>
    <td class="tg-031e">Video player's current playhead time</td>
  </tr>
  <tr>
    <td class="tg-031e">video_speed</td>
    <td class="tg-031e">Video player's current speed</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_old_time</td>
    <td class="tg-031e">For video_seek action: original playhead time</td>
  </tr>
  <tr>
    <td class="tg-031e">video_new_time</td>
    <td class="tg-031e">For video_seek action: new playhead time</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_seek_type</td>
    <td class="tg-031e">Control used for a video seek action</td>
  </tr>
  <tr>
    <td class="tg-031e">video_new_speed</td>
    <td class="tg-031e">For video speed change action: new speed</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_old_speed</td>
    <td class="tg-031e">For video speed change action: original speed</td>
  </tr>
  <tr>
    <td class="tg-031e">goto_from</td>
    <td class="tg-031e">Teaching sequence change: origin</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">goto_dest</td>
    <td class="tg-031e">Teaching sequence change: destination</td>
  </tr>
</table>
<p>

Here are a couple of example rows, with most of the video related
columns skipped. Those are more easily accessed using the
VideoInteraction table (see below):<br>

<b>EventXtract Example Rows:</b><br>
<pre>
+------------------------------------------+---------------+----------------+---------------------+---------------------------------------------+-----------------------+---------+------------+-|
| anon_screen_name | event_type    | ip_country            | time                | course_display_name   | resource_display_name | success | video_code |... more video cols... | goto_from | goto_dest |
+------------------------------------------+---------------+----------------+---------------------+---------------------------------------------+-----------------------+---------+------------+--
| 3fc...           | book          | USA                   | 2013-11-10 06:43:10 | Engineering/EE264/DSP |                       |         |            |                       |           |           |
| 6e9...           | problem_check | BEL                   | 2013-11-10 06:43:10 | Engineering/Solar/2013| I-V curve             |         |            |                       |           |           |
+------------------------------------------+---------------+----------------+---------------------+---------------------------------------------+-----------------------+---------+------------+--
</pre>
<p>
<!--
EventXtract AS
   SELECT anon_screen_name,
	  event_type,
	  ip,
	  time,
	  course_display_name,
	  resource_display_name,
	  success,
	  video_code,
	  video_current_time,
	  video_speed,
	  video_old_time,
	  video_new_time,
	  video_seek_type,
	  video_new_speed,
	  video_old_speed,
	  goto_from,
	  goto_dest
  FROM Edx.EdxTrackEvent
-->

<hr>
If your focus is video behavior analysis, then the <b>VideoInteraction</b>
table is the easiest to use. It just extracts the video events from
the EventXtract table; the video related information is the same in
both tables.
<p>
Note that participants can download videos, and subsequently use their
own, local player. The platform software will not 'see' such local
activities, so this table can underestimate video activity frequency.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2">VideoInteraction</th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">event_type</td>
    <td class="tg-031e">Type of video action the participant took</td>
  </tr>
  <tr>
    <td class="tg-031e">resource_display_name</td>
    <td class="tg-031e">Name of video</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_current_time</td>
    <td class="tg-031e">Video player's current playhead time</td>
  </tr>
  <tr>
    <td class="tg-031e">video_speed</td>
    <td class="tg-031e">Video player's current speed</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_new_speed</td>
    <td class="tg-031e">For video speed change: new speed</td>
  </tr>
  <tr>
    <td class="tg-031e">video_old_speed</td>
    <td class="tg-031e">For video speed change: old speed</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_new_time</td>
    <td class="tg-031e">For video seek: new playhead time</td>
  </tr>
  <tr>
    <td class="tg-031e">video_old_time</td>
    <td class="tg-031e">For video seek: old playhead time</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">video_seek_type</td>
    <td class="tg-031e">Video control used for seek</td>
  </tr>
  <tr>
    <td class="tg-031e">video_code</td>
    <td class="tg-031e">Machine code name for video.<br>
                        For YouTube videos this column allows you<br>
                        to find the video itself. For example,<br>
                        if this column contains '6Tnr8OL-9So' <br>
                        you can google that code, and will find<br>
                        the video.
  </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">time</td>
    <td class="tg-031e">Time the video action was taken</td>
  </tr>
  <tr>
    <td class="tg-031e">course</td>
    <td class="tg-031e">For video speed change action: new speed</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_display_name</td>
    <td class="tg-031e">Name of course for which action was taken</td>
  </tr>
  <tr>
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Teaching sequence change: destination</td>
  </tr>
  <tr>
    <td class="tg-031e">video_id</td>
    <td class="tg-031e">a unique OpenEdX id for this video</td>
  </tr>
</table>
<p>
Here again some example rows:<br>

<b>VideoInteraction Example Rows:</b><br>
<pre>
+------------------------------------------+---------------+----------------+---------------------+---------------------------------------------+----------------
| event_type  | resource_display_name | video_current_time |video_speed  | video_new_speed | video_old_speed | video_new_time | video_old_time | video_seek_type ...
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
| play_video  | Video 7.3.2: Hydrogen | 1244.047           | None        |                 |                 |                |                |                 
| pause_video | Video 7.3.2: Hydrogen | 1217.389976        | None        |                 |                 |                |                |                 ...
| play_video  | Video 7.2.2: Oxygen   | 101.046621         | None        |                 |                 |                |                |                 
+-------------+------------------------------------------------+--------------------+-------------+-----------------+-----------------+----------------+---------

    -------+---------+------------+----------------------------------------------|
... | video_code  | time                | course_display_name | anon_screen_name |
    -----------------------------------------------------------------------------|
    | ZO0_R5VAoG4 | 2013-11-10 06:43:12 | Eng/EE-222/ME_I     | ef04...          |
... | ZO0_R5VAoG4 | 2013-11-10 06:43:42 | Eng/EE-222/ME_I     | 84fa...          |
    | 6Tnr8OL-9So | 2013-11-10 06:43:43 | Eng/EE-222/ME_I     | 8998...          |
    -------+-----------------+-------------+---------------------+----------------
</pre>
<p>
<!--
CREATE VIEW VideoInteraction AS
SELECT event_type,
       resource_display_name,
       video_current_time,
       video_speed,
       video_new_speed,
       video_old_speed,
       video_new_time,
       video_old_time,
       video_seek_type,
       video_code,
       time,
       course_display_name,
       anon_screen_name
FROM Edx.EdxTrackEvent
WHERE  CHAR_LENGTH(video_code) > 0 OR
       CHAR_LENGTH(video_current_time) > 0 OR
       CHAR_LENGTH(video_speed) > 0 OR
       CHAR_LENGTH(video_old_time) > 0 OR
       CHAR_LENGTH(video_new_time) > 0 OR
       CHAR_LENGTH(video_seek_type) > 0 OR
       CHAR_LENGTH(video_new_speed) > 0 OR
       CHAR_LENGTH(video_old_speed) > 0
-->
<p>
The <b>ActivityGrade</b> table holds events that concern homework
assignments. Each row in the table is one solution submission, or
inspection of one assignment by one participant. The rows inform whether
the solution was correct, in some parts, or in its entirety. If only
parts were correct, the table shows which parts, and which incorrect
answers the participant provided.
<p>
<b>Note:</b>the ActivityGrade table is not constructed from EdX track
event logs. Instead, this table is composited from information in
the platform table courseware_studentmodule. In particular the
infamous JSON encoded <i>state</i> field in that table is parsed and
its JSON values are made accessible as columns in ActivityGrade.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2">ActivityGrade</th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">activity_grade_id</td>
    <td class="tg-031e">A unique identifier for this row</td>
  </tr>
  <tr>
    <td class="tg-031e">student_id</td>
    <td class="tg-031e">A numeric identifier used for participants in various other platform tables.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_display_name</td>
    <td class="tg-031e">Name of course for which assignment was created</td>
  </tr>
  <tr>
    <td class="tg-031e">grade</td>
    <td class="tg-031e">The grade the participant received for this
                        assignment.<br>
                        <img src="figs/expert.png" width="2%"> This
                        quantity originates from a JOIN between
                        auth_user and certificates_generatedcertificate.
  </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">max_grade</td>
    <td class="tg-031e">The maximum grade possible for this assignment</td>
  </tr>
  <tr>
    <td class="tg-031e">percent_grade</td>
    <td class="tg-031e">Percentage of grade from max_grade</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">parts_correctness</td>
    <td class="tg-031e">Series of plus and minus chars indicating which problem parts were answered correctly</td>
  </tr>
  <tr>
    <td class="tg-031e">answers</td>
    <td class="tg-031e">Answers the participant provided for the assignment.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">num_attempts</td>
    <td class="tg-031e">Total number of participant's attempts at this<br>
                       assignment at the time the event is
                       received. <br>
                       Note: each attempt generates an event, <br>
                       only the last attempt has the correct number. <br>
                       The number -1 stands for 'not applicable.' 
  </td>
  </tr>
  <tr>
    <td class="tg-031e">first_submit</td>
    <td class="tg-031e">This date is currently unreliable.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">last_submit</td>
    <td class="tg-031e">This date is currently unreliable.</td>
  </tr>
  <tr>
    <td class="tg-031e">module_type</td>
    <td class="tg-031e">The teaching module type</td>
  </tr>
  <tr>
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Participant's anonymized name</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">resource_display_name</td>
    <td class="tg-031e">Assignment name. This information is only as
    good as what instructors entered when they created the
    assignment. The module_id (next field) is a unique, automatically
    assigned name for the assignment. </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">module_id</td>
    <td class="tg-031e">Internal platform ID of the row's module.</td>
  </tr>
</table>
</pre>
<p>
<b>ActivityGrade Example Rows:</b><br>
<p>
<pre>
+------------------------------------------+---------------+----------------+---------------------+---------------------------------------------+-----------------------+---------+------------+------|
| course_display_name | grade | max_grade | percent_grade | parts_correctness |     answers       | numAttempts | first_submit | last_submit | module_type | resource_display_name | anon_screen_name |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|Medicine/101/Stats   |     2 |         2 |           100 | ++                | choice_1,choice_2 |           2 | 2013-05-13 12:42:40 | 2013-05-13 12:50:52 | problem     | Quiz   | 55e90...         |
|Medicine/101/Stats   |     0 |         2 |             0 | --                | choice_0,choice_4 |           1 | 2013-05-13 13:23:57 | 2013-05-13 13:32:33 | problem     | Quiz   | 95d8b...         |
+-------------+------------------------------------------------+--------------------+-------------+-----------------+-----------------+----------------+----------------+-----------------+------------
</pre>

<hr>

The <b>Demographics</b> view contains anonymized demographic data
on participants. A major consideration when using this table that
participants provide this information voluntarily. Some do, others
don't; some lie, others tell the truth.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2">Demographics</th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Participant's anonymized name</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">gender</td>
    <td class="tg-031e">Single letter: 'm' or 'f'. Blank if not provided.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">year_of_birth</td>
    <td class="tg-031e">Year of participant's birth, if
    provided. Else NULL</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">curr_age</td>
    <td class="tg-031e">Current age, computed on the fly from the year
       when the row producing SELECT is issued, and year_of_birth.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">level_of_education</td>
    <td class="tg-031e">One of: Doctorate, Masters or professional
                        degree, Bachelors, Associates, Secondary/High
                        School, Junior secondary/junior high/middle
                        School, Elementary/Primary School, None,
                        Other, User withheld, Signup before level
                        collected.</td> 
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">country_three_letters</td>
    <td class="tg-031e">Official three-letter code of country. If
                        participant interacted with a course from 
                        multiple Internet addresses, Demographics
                        will contain one entry for each distinct
                        address, even if the countries are the same.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">country_name</td>
    <td class="tg-031e">Full name of country. See
                        country_three_letters for explanation of 
                        multiple entries.
  </td>
  </tr>
</table>
</pre>
</div>
<p>
If participant interacted with a course from multiple Internet
addresses, Demographics will contain one entry for each distinct
address, even if the address' countries are the same. It is therefore
wise to use DISTINCT when querying:

<pre>
mysql> SELECT DISTINCT Demographics.*, FinalGrade.grade  
       FROM Demographics, FinalGrade 
       WHERE Demographics.anon_screen_name = FinalGrade.anon_screen_name  
        AND  FinalGrade.course_id = 'Engineering/Solar/Fall2013' 
       LIMIT 4;
+------------------------------------------+--------+---------------+----------+--------------------+-----------------------+---------------+-------+
| anon_screen_name                         | gender | year_of_birth | curr_age | level_of_education | country_three_letters | country_name  | grade |
+------------------------------------------+--------+---------------+----------+--------------------+-----------------------+---------------+-------+
| 18070a6cbf7c75ea6b6a53cf08d875e50a4dc1fb | m      |          1989 |       25 | User withheld      | BGR                   | Bulgaria      |     0 |
| f42a592a30690dc43bdd3d0ece1019c79b88c8ac | m      |          1987 |       27 | Bachelors          | USA                   | United States |     0 |
| 20bd8681086b0ddb994e1fec2d0de110f55bc1da | m      |          1990 |       24 | Bachelors          | USA                   | United States |     0 |
| 610467062fa05ff271198cfcc689febe856f48e7 |        |          NULL |     NULL | User withheld      | FRA                   | France        |     0 |
+------------------------------------------+--------+---------------+----------+--------------------+-----------------------+---------------+-------+
</pre>

<hr>

<p>
All <b>Forum post</b> entries are scrubbed of personally identifiable
information. The following are redacted: phone numbers, zip codes,
email addresses, and the poster's name. In each case the type of
redacted information can be determined by the redaction text. For
example, you will see &lt;emailRedac&gt;, or &lt;zipRedac&gt;. For
poster names you will see
&lt;nameRedac_anon_screen_name_redacted&gt;. These replacements keep
word count intact. Unfortunately, international zip codes are varied
enough that detecting them results in many false positives. Some
non-zip numeric information is therefore redacted for no good
reason. Conversely you may find some text that does identify someone
in the course directly or indirectly. We do the best we can at the
scale of information. Human inspection of a 30,000 post samples
revealed a scrubbing success rate of 98.4%. Please be respectful if
you do find one of the rare cases where identification is
possible. Keep the information to yourself,
and <a href="mailto://paepcke@cs.stanford.edu">report it to us</a> so
that we can fix the problem.
<p>
Here is a complication stemming from privacy protection: you will find
the anon_screen_name column filled with the single value
'anon_screen_name_redacted'. You can therefore not use this column to
select by participant as you do on all the other tables. Instead, when
selecting from the EdxForum.contents table, you need to use
column <i>forum_uid</i>.
<p>
This approach works fine while working within the Forum table
only. But the setup prevents you from relating Forum posts to other
tables to find correlations between Forum postings and, say, grade
outcomes.
<p>
The reason for this separation is a known attack onto the privacy in
the non-Forum tables when the same participant code is used in both
worlds. We call the fully redacted Forum table <i>non-relatable</i>.
<p>
To explore correlations you need a translation from
the <i>forum_uid</i> in the Forum table to the <i>anon_screen_name</i>
used in all other tables. To receive that translation,
please <a href="http://vpol.stanford.edu/research">fill out the
application form</a> that you filled out before to gain access to the
data. This time, please make very clear in the free-form text field
that you already have access to the data, and that you just need the
additional Forum translation information.
<p>
Forum posts contain a number of identifiers. Here is an explanation of
relationships between these identifies. This explanation is based on
observation, not on documentation from the original software; the
information may therefore be incorrect or incomplete:
<ul>

<li><b>forum_post_id:</b> identifies the post in a given row. This is
   usually a question, but could be a comment.</li>
<li><b>comment_thread_id:</b> matches the original
   <i>forum_post_id</i> that started the thread in which
   the current post is a comment or reply.</li>
<li><b>parent_id:</b> identifies the immediate predecessor of the
   row's post in the thread of which the post is a part.</li>
<li><b>parent_ids:</b> provides a full chain from the
   thread-originating post to the current comment/reply.</li>
</ul>

<p>
Each Forum post is contained in one row:
<p>
<div align="center">
<style>
    .data-table {
        border-collapse: collapse;
    }
    .border-top {
        border-top: 1px solid #000;
    }
    .border-bottom {
        border-bottom: 1px solid #000;
    }
    .border-left {
        border-left: 1px solid #000;
    }
    .border-right {
        border-right: 1px solid #000;
    }
</style>


<table class="data-table">
    <tr>
        <th colspan="2" class="border-top border-bottom border-left border-right">OpenEdX Forum Table</th>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">forum_post_id</td>
        <td class="border-bottom border-right">unique id for this
              post; used in other columns of other posts to refer to
              this row. This ID is assigned by the OpenEdX
             Forum software.
	</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">anon_screen_name</td>
        <td class="border-bottom border-right">anonymized participant ID (redacted unless table is relatable)</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">type</td>
        <td class="border-bottom border-right">type of post: currently Comment or CommentThread</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">anonymous</td>
        <td class="border-bottom border-right">whether post was submitted anonymously</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">anonymous_to_peers</td>
        <td class="border-bottom border-right">anonymous to peers</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">at_position_list</td>
        <td class="border-bottom border-right">apparently unused</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">forum_uid</td>
        <td class="border-bottom border-right">anonymized poster ID;
        different from anon_screen_name. <a href="http://vpol.stanford.edu/research">Need
        permission</a> to convert from <i>forum_uid</i>
        to <i>anon_screen_name</i>. Use functions <code>idForum2Anon()/idAnon2Forum()</code> for conversion
            between them. 
	</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">body</td>
        <td class="border-bottom border-right">anonymized body of the post. Redacted: emails, phone numbers, zip codes, name of poster</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">course_display_name</td>
        <td class="border-bottom border-right">name of course with which the entry is associated</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">created_at</td>
        <td class="border-bottom border-right">date of creation</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">votes</td>
        <td class="border-bottom border-right">original JSON that summarizes votes. It is recommended to instead use the broken out columns below</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">count</td>
        <td class="border-bottom border-right">total number of votes: up or down</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">down_count</td>
        <td class="border-bottom border-right">number of down votes</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">up_count</td>
        <td class="border-bottom border-right">number of up votes</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">up</td>
        <td class="border-bottom border-right">list of individual up votes</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">down</td>
        <td class="border-bottom border-right">list of individual down votes</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">comment_thread_id</td>
        <td class="border-bottom border-right">ID of thread. Refers
                  to forum_post_id of ur-post.</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">parent_id</td>
        <td class="border-bottom border-right">ID of parent post (see above).</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">parent_ids</td>
        <td class="border-bottom border-right">chain of post IDs in
           thread (see above).</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">sk</td>
        <td class="border-bottom border-right">Used by Forum software
        for caching</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">confusion</td>
        <td class="border-bottom border-right">reserved for sentiment
              analysis results.</td>
    </tr>
    <tr>
        <td class="border-bottom border-left border-right">happiness</td>
        <td class="border-bottom border-right">reserved for sentiment
              analysis results.</td>
    </tr>
</table>
</div>

<p>
<b>EdxForum Example Rows:</b><br>

<pre>
+--------------------------+-----------------------------+---------------+-----------+--------------------+------------------+----------------------------------+
| forum_post_id            | anon_screen_name            | type          | anonymous | anonymous_to_peers | at_position_list | forum_uid                        | ...
+--------------------------+-----------------------------+---------------+-----------+--------------------+------------------+----------------------------------+
| 519461545924670200000001 | &lt;anon_screen_name_redacted> | CommentThread | False     | False              | []               | AD0EB4DEEB4DC139D8FDA01000EDAE3E |
| 519461545924670200000005 | &lt;anon_screen_name_redacted> | Comment       | False     | False              | []               | 5F43341D3FDA2BBE001D8DBBB84BB3E5 | ...
| 519461555924670200000006 | &lt;anon_screen_name_redacted> | Comment       | False     | False              | []               | 5CA0BD47154EB68991F10C7F464F3BF3 |
+--------------------------+-----------------------------+---------------+-----------+--------------------+------------------+----------------------------------+


    +--------------------------------------------------------------------
... | body            | course_display_name      | created_at           | ...
    +--------------------------------------------------------------------
    | This is a post. | Engineering/CS144/Spring | 2013-05-16 04:32:20  |  
... | Another post    | MITx/6.002x/2012_Fall    | 2013-05-16 04:32:20  | ...
    | Third post      | MITx/6.002x/2012_Fall    | 2013-05-16 04:32:21  |
    +--------------------------------------------------------------------


    +----------------------------------------------------------------------------------------------------------------------------------
... | votes                                                                                                                           | ...
    +----------------------------------------------------------------------------------------------------------------------------------
    | {'count': 10, 'point': -6, 'down_count': 8, 'up': ['2', '10'], 'down': ['1', '3', '4', '5', '6', '7', '8', '9'], 'up_count': 2} |
... | {'count': 10, 'point': 4, 'down_count': 3, 'up': ['1', '2', '5', '6', '7', '8', '9'], 'down': ['3', '4', '10'], 'up_count': 7}  | ...
    | {'count': 10, 'point': -4, 'down_count': 7, 'up': ['6', '8', '10'], 'down': ['1', '2', '3', '4', '5', '7', '9'], 'up_count': 3} |
    +----------------------------------------------------------------------------------------------------------------------------------

    +--------------------------------------------------------------------------------+-----------------------+---------------------+-------------
... | count | down_count | up_count | up                                  | down                                     | comment_thread_id        | ...
    +--------------------------------------------------------------------------------------------------------------------------------------------
    |    10 |          8 |        2 | ['2', '10']                         | ['1', '3', '4', '5', '6', '7', '8', '9'] | None                     |
... |    10 |          3 |        7 | ['1', '2', '5', '6', '7', '8', '9'] | ['3', '4', '10']                         | 519461545924670200000001 | ...
    |    10 |          7 |        3 | ['6', '8', '10']                    | ['1', '2', '3', '4', '5', '7', '9']      | 519461545924670200000001 |
    +--------------------------------------------------------------------------------------------------------------------------------------------


    +----------------------------------------------------------------------------
... | parent_id | parent_ids | sk                       | confusion | happiness |                                                                                                                                                                                                                                                                                                                                                                                                                         
    +----------------------------------------------------------------------------
    | None      | None       | None                     |           |           |                                                                                                                                                                                                                                                                                                                                                                                                                         
... | None      | []         | 519461545924670200000005 |           |           |                                                                                                                                                                                                                                                                                                                                                                                                                         
    | None      | []         | 519461555924670200000006 |           |           |                                                                                                                                                                                                                                                                                                                                                                                                                         
    +----------------------------------------------------------------------------
</pre>

The <b>CourseInfo</b> table is constructed from the
OpenEdX <i>modulestore</i> MongoDB structure.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2">CourseInfo</th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_display_name</td>
    <td class="tg-031e">Course name as used in other tables of the archive.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_catalog_name</td>
    <td class="tg-031e">The course name as shown in the course catalog.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">academic_year</td>
    <td class="tg-031e">The <b>academic</b> year in which this row's
        course ran. For example, a course that ran in the Fall quarter
        of 2013 will have 2013 in this field. If the course instead
        ran in, say, the Spring quarter of that same academic year
        (2013/2014), this field will again contain 2013, even though
        the course would have run in the calendar year 2014.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">quarter</td>
    <td class="tg-031e">The academic quarter in which the course was
        offered. This value will be one of 'fall,', 'winter,',
        'spring,' or 'summer.'</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">num_quarters</td>
    <td class="tg-031e">Duration of the course in academic
        quarters. This number is computed from the start and end
        dates in the OpenEdX platform table <i>modulestore</i>. When
        that source does not provide an instruction end date, then
        this field is set to -1, because the correct entry cannot be
        computed. </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">is_internal</td>
    <td class="tg-031e">A 1 if the course was public. A 0 if the
        course was either for Stanford students only, or was offered
        for a fee. </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">enrollment_start</td>
    <td class="tg-031e">Date at which the platform opened this course
        for enrollment.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">start_date</td>
    <td class="tg-031e">Date when instruction began.</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">end_date</td>
    <td class="tg-031e">Date when instruction ended.</td>
  </tr>
</table>
</pre>
</div>
<p>
Example rows:
<pre>        
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| course_display_name                          | course_catalog_name              | academic_year | quarter | num_quarters | is_internal | enrollment_start    | start_date          | end_date            |
| HumanitiesSciences/Physics101E/Spring2014    | The Special Theory of Relativity |          2012 | summer  |           -1 |           0 | 0000-00-00 00:00:00 | 2013-08-18 00:00:00 | 0000-00-00 00:00:00 |
| Medicine/HRP258/Statistics_in_Medicine       | Statistics in Medicine           |          2012 | summer  |            1 |           0 | 2013-05-10 00:00:00 | 2013-06-11 00:00:00 | 2013-08-18 00:00:00 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
</pre>

<h3 id="engageDetail">Engagement Export Tables</h3>

Engagement data for one class consists of three tables. One lists all
dates, times, and durations of each session by every participants in
the class. The second lists the weekly number of minutes each
participant spent on the course. The third shows a summary of how many
minutes participants spent in the aggregate on the course, the total
number of work sessions, and three counts: the number of times that
participants' weekly median session length was between 1 and 20
minutes, the number of times participants' weekly median session
length was 21 minutes to 1hr, and the number of times their weekly
median session length was greater than one hour.
<p>
For example, say a course with 3 learners lasts for two weeks.  The
first week two learners had an observed median session length of 15
minutes. One learner's median was 2hrs. The second week of the course
one learner's median was 25 minutes, and the other two learners
engaged for a median of 13 minutes.
<p>
The Median1-20 would be (2 + 2 = 4), the Median21-1hr would be 1, and
the Median>1hr would be 1.
<p>
Notice that the median statistically dampens the impact of
outliers. For example, say one learner has all course materials
available from an earlier course offering. The eager participant runs
through the entire course during the first week, staying up through
long sessions all through the night. For the remaining weeks the
learner rests. What is the effect on the weekly session length? The
answer depends on what the other learners were doing. If no learner
touched the course during the first week, the median will be dominated
by the eager learner, and the number of weeks during which the median
was greater than one hour will be incremented. 
<p>
If instead many learners are active during the first week, but they
all only put in very short sessions, then the median will favor those
short sessions, and instead of incrementing the number of weeks in
which the median was greater than one hour, the number of weeks in
which the median was in the short session category will be incremented
instead. Thus, the week counts by median communicate a <i>typical</i>
level of engagement. If your research goal calls for a more fine
grained analysis, the first of the three tables is for you. As
explained, that table lists all sessions.
<p>
The first table in this group is usually large, because it lists
each <i>session</i> of each participant in a class. A session is
defined as a series of actions a participant undertook on the computer
while interacting with the course such that:
<ol>
  <li>The actions were detectable by the platform software, i.e. the
      actions triggered a logging event.</li>
  <li>No two actions were more than 30 minutes apart.</li>
</ol>
When more than 30 minutes elapse between two events, the second event
is considered part of a subsequent session. Since the last event's
duration is not delimited by a follow-on action in the same session,
the last event is special. One might apportion no time to that last
event. Another option is to apportion the median inter-event time
lapse (which is 500sec). To be conservative we have settled on
apportioning 1sec to the last event. This decision implies that
the engagement computation underestimates the true result.
<p>
Note that this accounting of time engagement is quite approximate even
disregarding the decision about the last event's duration. For
example, participants might read course related materials for an hour
without generating a platform event. No event: no accounting for that
time. A similar short change occurs when participants work on a
paper-and-pencil assignment.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
</style>
<table class="tg">
  <tr>
    <th class="tg-s6z2" colspan="2"><b>Engagement_AllData</b></th>
  </tr>
  <tr>
    <td class="tg-031e">Platform</td>
    <td class="tg-031e">Platform where course ran<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Course</td>
    <td class="tg-031e">Name of course<br></td>
  </tr>
  <tr>
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Hashed name of participant<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Date</td>
    <td class="tg-031e">Date when the row's participant session occurred<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Time</td>
    <td class="tg-031e">Time when the row's participant session started<br></td>
  </tr>
  <tr>
    <td class="tg-031e">SessionLength (sec)</td>
    <td class="tg-031e">Length of session in seconds</td>
  </tr>
  <tr>
    <td class="tg-031e">NumEventsInSession</td>
    <td class="tg-031e">Number of events that comprise this row's session</td>
  </tr>
</table>
<p>
A few example lines from an engagement_allData table:
<center><img src="figs/engagement_alldata.png"/></center>
<p>

The engagement_weeklyEffort table lists the sum of session lengths for
each participant for each week.
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
</style>
<table class="tg">
  <tr>
    <th class="tg-s6z2" colspan="2"><b>Engagement_weeklyEffort</b></th>
  </tr>
  <tr>
    <td class="tg-031e">Platform</td>
    <td class="tg-031e">Platform where course ran<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Course</td>
    <td class="tg-031e">Name of course<br></td>
  </tr>
  <tr>
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Hashed name of participant<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Week</td>
    <td class="tg-031e">Running week of the course; starting with 1
          for first week of the course.<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Effort (sec)<br></td>
    <td class="tg-031e">Number of minutes expended by the row's participant during the row's week<br></td>
  </tr>
</table>
<p>
A typical row in engagement_weeklyEffort looks like this:
<center><img src="figs/engagement_weeklyEffort.png"/></center>

<p>
The final table in the engagement group is a single row for each
course. The row summarizes the efforts across all weeks in one
course. If a single course is being exported, then the table will
contain only one line. 
<p>
This table provides an overview of session lengths that learners tended to 
invest in a course. For example, if the number of weeks in which the median 
session length exceeded one hour is high, then learners had to invest
long, contiguous studying times throughout most of the course. In contrast,
if the number of weeks in which the median session length was 1-20min 
is high, then the course tended to have students frequently engage
for short periods of time.
<p>
As an extreme, consider a learner who works through an entire course
in the first week, then sits out the remaining time. (This example
would require all course materials to be available from the start.)
This learner would possibly increment the greater-than-one-hour week
count by one. Whether or not that increment occurs depends on the
behavior of other learners during that same week. If everyone else
only spent 1 minute during that week, the median would be 1-20min for
that week, and the corresponding 1-20min count would be incremented
instead of the greater-than-one-hour count.
<p>
This summary measure is therefore not sensitive to extreme
behaviors by individual learners. Such learners do not unduly distort
the result. Note, however, that the summary measure does not 
tell us <i>when</i> in a course long sessions prevailed.
<p>
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
</style>
<table class="tg">
  <tr>
    <th class="tg-s6z2" colspan="2"><b>Engagement_summary</b></th>
  </tr>
  <tr>
    <td class="tg-031e">Platform</td>
    <td class="tg-031e">Platform where course ran<br></td>
  </tr>
  <tr>
    <td class="tg-031e">Course</td>
    <td class="tg-031e">Name of course<br></td>
  </tr>
  <tr>
    <td class="tg-031e">TotalStudentSessions</td>
    <td class="tg-031e">Total number of sessions by all participants in the course<br></td>
  </tr>
  <tr>
    <td class="tg-031e">TotalEffortAllStudents(secs)<br></td>
    <td class="tg-031e">Sum of seconds from all participants' sessions in the course<br></td>
  </tr>
  <tr>
    <td class="tg-031e">MedPerWeekOneToTwenty</td>
    <td class="tg-031e">The number of times a weekly median of 1 to
         20 minutes of time engagement was observed, counting each participant, each week.</td>
  </tr>
  <tr>
    <td class="tg-031e">MedPerWeekTwentyoneToSixty</td>
    <td class="tg-031e">The number of times a median of 21min to 1hr
        of time engagement was observed, counting each participant, each week.</td>
  </tr>
  <tr>
    <td class="tg-031e">MedPerWeekGreaterSixty</td>
    <td class="tg-031e">Median number of sessions with weekly median
         larger than one hour.<br></td> 
  </tr>
</table>
<p>
A typical row in engagement_summary looks like this:
<center><img src="figs/engagement_summary.png"/></center>

<p>
<hr>
<p>
The following tables are only available.
by <a href="#accessProcedure">special arrangement</a>

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 8px;border-style:solid;border-width:1px;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;}
</style>
<table class="tg">
  <tr>
    <th colspan="2" class="tg-s6z2"><b>UserGrade</b></th>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">name</td>
    <td class="tg-031e">Participant's self reported name</td>
  </tr>
  <tr>
    <td class="tg-031e">screen_name</td>
    <td class="tg-031e">Participant's choice of name for him/herself on the online learning platform</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">grade</td>
    <td class="tg-031e">Currently known
      grade.<br> (<img src="figs/expert.png" width="2%">
                        The information comes
                        from platform tables auth_user and
                        certificates_generatedcertificate.)
    </td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">course_id</td>
    <td class="tg-031e">Name of course in format foo/bar/fum</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">distinction</td>
    <td class="tg-031e">0 or 1</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">status</td>
    <td class="tg-031e">downloadable, generating, notpassing, or unavailable</td>
  </tr>
  <tr class="tg-even">
    <td class="tg-031e">user_int_id</td>
    <td class="tg-031e">Integer identifier for participant as used in
                        platform native
                        tables.<br> (<img src="figs/expert.png"
                        width="2%">This is the same value as the
                        student_id column in courseware_studentmodule.)
   </td> 
  </tr>
  <tr>
    <td class="tg-031e">anon_screen_name</td>
    <td class="tg-031e">Anonymization code used for this
                        participant. Since this table contains both<br>
                        the integer ID used on platform tables, and<br>
                        the 40 byte id used elsewhere on datastage,<br>
                        this table is used for translation. See<br>
                        stored functions idInt2Anon() and
                        idAnon2Int().)
    </td>
  </tr>
</table>
<p>

<h3 id="mirrors">Platform tables mirrored on Datastage</h3> 

This list may change. To add additional tables, see 
script json_to_relation/scripts/cronRefreshEdxprod.sh.
<a href="https://media.readthedocs.org/pdf/edx/latest/edx.pdf">
Documentation for these tables</a> is provided by the EdX consortium.
<ul>
<li>auth_user</li>
<li>auth_userprofile</li>
<li>certificates_generatedcertificate</li>
<li>courseware_studentmodule</li>
<li>courseware_studentmodulehistory</li>
<li>external_auth_externalauthmap</li>
<li>student_anonymoususerid</li>
<li>student_courseenrollment</li>
</ul>
<p>
<h3 id="functions">Useful MySQL Functions</h3>

If you query the database directly, the following stored functions and procedures 
might prove useful. Some of the functions are privileged because they perform
user id conversions that would put privacy in peril. Those functions
can only be used with the prefix <i>EdxPrivate</i>. You'll know that
you hit on one of these if you try to use a function, and MySQL
complains that the function does not exist. The current set of 
private functions are tagged with an asterisk in the table below.
<br>
Note that there is a difference between MySQL functions, and MySQL procedures. 
A function is invoked as if it were a built-in function, like MIN(), or COUNT().
Examples: 
<pre>
SELECT wordcount('I love data');
SELECT * FROM EventXtract WHERE anon_screen_name = idInt2Anon(44000);
</pre>
However, note that due to MySQL not being smart sometimes, the second
SELECT above is much slower than the following idiom:
<pre>
SELECT idInt2Anon(44000) INTO @theAnon;
SELECT * FROM EventXtract WHERE anon_screen_name = @theAnon;
</pre>
In contrast to functions, a procedure must be called in a separate
statement, and a return variable must be provided. The idiom is:
<pre>
CALL computeEnrollmentCoursera('antimicrobial-001', @theEnrollment);
SELECT @theEnrollment;
</pre>

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg .tg-e3zv{font-weight:bold}
</style>
<table class="tg" style="undefined;table-layout: fixed; width: 907px">
<colgroup>
<col style="width: 419px">
<col style="width: 488px">
</colgroup>
  <tr>
    <th class="tg-e3zv">Function/Procedure</th>
    <th class="tg-031e">Explanation<br></th>
  </tr>
  <tr>
    <td class="tg-e3zv">earliestLog()</td>
    <td class="tg-031e"><br>the earliest OpenEdX event log load date/time. The function provides two times:  'Loaded' is the time when the earliest log was loaded into Datastage. Collected is the date when the log was originally created.</td>
  </tr>
  <tr>
    <td class="tg-e3zv">latestLog()</td>
    <td class="tg-031e">the most recent OpenEdX event log date. The 'loaded' date is supposed to show when the log was loaded into Datastage. But this date is unreliable. The second date is the date the log was created.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idAnon2Int(anon_screen_name)</td>
    <td class="tg-031e">takes a learner identifier that as encoded in the Datastage archive. Returns an integer identifier for the same learner, as used in tables generated by the OpenEdX production platform.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idInt2Anon(openEdxPlatformLearnerId)<br></td>
    <td class="tg-031e">takes an integer learner ID as used in OpenEdX production tables. Returns the corresponding anon_screen_name hash value used in the archive.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idAnon2Ext(anon_screen_name, course_display_name)</td>
    <td class="tg-031e">converts an anon_screen_name learner ID and course name pair to an LTI ID as used in Qualtrics and other outside vendors.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idAnon2Exts(anon_screen_name)<br>(procedure)<br></td>
    <td class="tg-031e">procedure takes an anon_screen_name, and fills a temporary memory table with all external LTI-uid/course name,pairs. The procedure creates a temporary in-memory table of, two columns: <br>   ext_id, course_display_name.<br>The new table is called ExtCourseTable, and is available after, the procedure call returns. The table is wiped and renewed with, every call. Each MySQL connection has its own temp table name space, so no collision with other connections occurs. The table vanishes with connection closure.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idExt2Anon(ltiExternalId)</td>
    <td class="tg-031e">given an external, LTI learner ID as used in Qualtrics and other outside services, return the corresponding anon_screen_name.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idInt2Forum(openEdxPlatformLearnerId)</td>
    <td class="tg-031e">convert integer learner IDs as used in platform production tables to ID used in forum table for the same learner.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idForum2Int(openEdxPlatformLearnerId)*</td>
    <td class="tg-031e">convert forum learner IDs to integer learner IDs as used in platform production tables.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">idForum2Anon(forumArchiveLearnerId)*</td>
    <td class="tg-031e">convert learner ID used in forum table to hash, values used in anon_screen_name columns</td>
  </tr>
  <tr>
    <td class="tg-e3zv">wasCertified(anon_screen_name)</td>
    <td class="tg-031e">return 1 if OpenEdX learner was issued a certificate, else return 0.</td>
  </tr>
  <tr>
    <td class="tg-e3zv">isUserEvent(event_type)</td>
    <td class="tg-031e">given a user event type, return 1 if that type of event is triggered by a user action, as opposed to one by the OpenEdX platform server<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">wordcount(string)</td>
    <td class="tg-031e">this function works by passing a string, or it can be used to compute the sum of words in an entire colum: SELECT SUM(wordcount(body)) FROM (SELECT body FROM contents) AS Contents;</td>
  </tr>
  <tr>
    <td class="tg-e3zv">enrollment(course_display_name)</td>
    <td class="tg-031e">given an OpenEdX course name, return its current enrollment.<br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">computeEnrollmentCoursera(course_name)<br>(procedure)<br></td>
    <td class="tg-031e">given a course name that ran on Coursera, return its enrollment. All the following course name examples are acceptable:<br>
       <ul>
       <li>coursera_antimicrobial-001_demographics</li>
       <li>antimicrobial-001_demographics</li>
       <li>antimicrobial-001_anonymized_general</li>
       <li>antimicrobial-001</li>
       </ul>
       <br></td>
  </tr>
  <tr>
    <td class="tg-e3zv">computeEnrollmentNovoEd(course_name)</td>
    <td class="tg-031e">given a course name that ran on NovoEd, return its enrollment. All the following course name examples are acceptable:<br>
        <ul>
	<li>novoed_crs_93</li>
	<li>novoed_crs_email_93</li>
	<li>93</li>
	</ul>
	<br></td>
  </tr>
  <tr>
    <td class="tg-031e">* procedure or function is only available in EdxPrivate.</td>
    <td class="tg-031e"></td>
  </tr>
</table>

<html>
<head>
</head>
<body>
